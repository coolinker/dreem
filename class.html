<html>
<head>
	<title>rhes.es</title>
	<style type="text/css">
	  body {
		  background-color: rgb(46,36,30);
		  background-image: url(img/x2/background-r.png);
		  background-size: 259px 259px;
	  }
	  @font-face {
	    font-family: 'wildride';
	    src: url('fonts/WildRide.ttf') format('truetype');
	    font-weight: normal;
	    font-style: normal;
		}
	  .trans {
	  	background-color: rgba(255,255,255,.5);
	  	width: 80%;
	  	height: 80%;
	  	display:none;
	  }
	  #logo {
		  background-repeat: no-repeat;
		  width:171;
		  height:64;
		  position: absolute;
		  background-image: url(img/x2/rheses-color.png);
		  background-repeat: no-repeat;
		  background-size: 171px 64px;
	  }
	  #slogan {
		  font-family: wildride;
		  white-space: nowrap;
		  color: rgb(154,123,75);
		  font-size: 72px;
		  position: absolute;
      text-shadow: 0px 0px 4px rgb(46,36,30);
		}
	</style>
	<script type="text/javascript" src="jquery-1.9.1.js"></script>
	<script type="text/javascript" src="acorn.js"></script>
	<script type="text/javascript" src="underscore.js"></script>
	<script type="text/javascript" src="layout.js"></script>
</head>
<body>
	<view id="container" y="300" width="100" height="100">
		<class name="simplelayout" extends="layout">
			<attribute name="attribute" type="string" value="x"></attribute>
			<attribute name="inset" type="number" value="10"></attribute>
			<attribute name="spacing" type="number" value="15"></attribute>
			<attribute name="axis" type="string" value="width"></attribute>
			<handler name="onsubview" args="subview">
				//console.log('onsubview', arguments, this)
				value.bind(this.axis, this.update)
			</handler>
			<setter name="spacing" args="spacing">
				this.spacing = spacing
				//console.log('spacing setter', spacing, this)
				this.update()
			</setter>
			<setter name="attribute" args="attr">
				var axis = 'width'
				if (attr == 'y') {
					axis = 'height'
			  }
			  if (this.axis != axis) {
			  	if (this.parent && this.parent.subviews) {
				  	for (var i = 0, l = this.parent.subviews.length; i < l; i++) {
					  	var subview = this.parent.subviews[i];
					  	//console.log('unbinding', this.axis, subview.events);
					  	subview.unbind(this.axis, this.update).bind(axis, this.update)
					  }
					}
				 	this.axis = axis
			  }

			 	this.attribute = attr
				console.log('attribute setter', this.axis, this.attribute)
				this.update()
			</setter>
			<method name="update" args="value, sender">
        var pos, skip, subview, _i, _len, _ref, _results;
	      //console.log('update override', value, sender)

        if (this.skip()) {
          //console.log('skipping')
          return;
        }
        //console.debug('params', this.spacing, this.attribute, this.axis, this.inset);
        pos = this.inset;
        if (sender) {
          skip = true;
        }
        _ref = this.parent.subviews;
        //console.log('subviews', _ref)
        for (_i = 0, _len = _ref.length; _i < _len; _i++) {
          subview = _ref[_i];
          if (skip && subview !== sender) {
            //console.log('skipping')
          } else {
		        //console.log('subview', subview, this.attribute, pos, subview.setAttribute)
            if (subview[this.attribute] !== pos) {
              subview.setAttribute(this.attribute, pos);
            }
            skip = false;
          }
          pos += this.spacing + subview[this.axis];
        }
      </method>
		</class>
		<simplelayout name="lay" spacing="42">
			<handler name="oninit">
				//console.log('oninit instance', this)
				this.hello('a', 'b', 'c')
			</handler>
			<method name="hello" args="a,b,c">
				//console.log('hello instance', a,b,c, this)
			</method>
		</simplelayout>
 		<view width="10" height="10" bgcolor="red"></view>
		<view width="10" height="10" bgcolor="yellow"></view>
		<view width="10" height="10" bgcolor="green" id="grn"></view>
		<view width="10" height="10" bgcolor="black"></view>
		<view width="10" height="10" bgcolor="blue"></view>
	</view>
</body>
</html>