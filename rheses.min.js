var rheses=function(){var n,t,e,o,r,s,i,a,u,c,f,p,l,d,h,m,g=!1,w=$.fn.css;return $.fn.css=function(){var n,t,e,o,r,s;if(w.apply(this,arguments),!g)for(n={},"object"!=typeof arguments[0]?n[arguments[0]]=arguments[1]:n=arguments[0],t=$(this),e=0,o=t.length;o>e;e++)if(r=$.data(t[e],"sendstyle"))for(s in n)r[s]&&t.trigger("style-"+s);return this},n=$.fn.animate,$.fn.animate=function(){var t,e,o,r,s,i,a,u,c=Array.prototype.slice.call(arguments,0);if(!g){"object"!=typeof c[1]&&(c[1]={duration:c[1],easing:c[2],complete:c[3]},c.length=2),t=$(this),e={},o=!1;for(r in c[0])for(s=0,i=t.length;i>s;s++)if(a=$.data(t[s],"sendstyle"),a&&a[r]){o=e[r]=!0;break}o&&(u=c[1].step,c[1].step=function(){u&&u.call(this,arguments);for(var n in e)t.trigger("style-"+n)})}return n.apply(this,c)},t=window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(n){setTimeout(n,17)},Mouse=function(){var n=0,e=0,o=null,r=!1,s=null,i=function(){o&&t(i),r&&(r=!1,s.trigger("move"))},a=function(t){n=t.pageX,e=t.pageY,r=!0},u=$(document),c=function(){null===o&&(s=l.selector=$(Mouse)),o||(o=!0,t(i),u.on("mousemove",a),u.one("mouseout",f))},f=function(){o&&(o=!1,u.off("mousemove",a),u.one("mouseover",c))},p=function(){return{top:e,left:n}},l={start:c,stop:f,position:p,offset:p};return l}(),e={top:"position().top",left:"position().left",width:"width()",height:"height()",parent:"parent()"},o={scope:"this"},o.process=function(n){var t=function(n){for(;n.object&&"MemberExpression"===n.object.type;)n=n.object;return n.object||n},e=function(n,e){var o=t(n),r=o.name;e&&(o.name="$("+e+")","this"===e&&(o.name+="."+r))};this.scope="this",acorn.walkDown(n,this),e(n,this.scope)},o.Identifier=function(n){var t,r=n.name;r in e?n.name=e[r]:r in window&&(t=window[r],o.scope=t instanceof HTMLElement?"'#"+r+"'":t===window||t===document?r:null)},o.ThisExpression=function(n){n.type="Identifier",n.name="$(this)",o.scope=null},r={},r.MemberExpression=function(n){return o.process(n),!0},s={foundScopes:[]},i={Math:!0},s.MemberExpression=function(n){if(n.object.name in i)return!0;var t=n.property.name;return n=n.object,o.process(n),s.foundScopes.push({scope:acorn.stringify(n),propname:t}),!0},findScopes=function(n){var t=acorn.parse(n);return s.foundScopes=[],acorn.walkDown(t,s),s.foundScopes},a=function(n,t){return Function([],n).bind(t)},u=function(n){var t;try{t=acorn.parse(n)}catch(e){return console.error("Failed to parse",n,"for",cssprop,"of",el),!1}return acorn.walkDown(t,r),acorn.stringify(t)},c=function(n,t,e){function o(n,t){n.on(t,s.update),p.push(n,t)}var r,s,i,c,f,p;return parsedExpression=u(e),r=$.data(n,"constraints")||{},$.data(n,"constraints",r),r[t]?!1:(r[t]={scopes:[]},s=r[t],i=$(n),c=a("return "+parsedExpression,i),s.update=function(n){n&&n.stopPropagation(),g||i.css(t,c())},f={},p=s.scopes,findScopes(e).forEach(function(r){var s,u,c,p,l=r.scope,d=r.propname,h=l+"."+d;if(!f[h]&&(s=a("return "+l,i)(),0!==s.length)){if(s.length>1&&console.warn('"'+l+'" may have an error. Found multiple scopes, only using the first in: ',s),u=s&&s[0],u===n&&d===t)return console.warn('Not binding: expression "'+e+'" may have an error binding to own property',t,"on element",n),void 0;f[h]=!0,c=u&&(u===window||"body"===u.localName),!c||"width"!==d&&"height"!==d?s===Mouse&&(Mouse.start(),o(Mouse.selector,"move")):o($(window),"resize"),u instanceof HTMLElement&&(p=$.data(u,"sendstyle")||{},p[d]=!0,$.data(u,"sendstyle",p),o(s,"style-"+d))}}),s.update(),this)},f=function(n,t){var e,o,r,s,i,a,u,c=$.data(n,"constraints");if(c){for(e=c&&c[t],o=e.update,r=e.scopes,s=0,i=r.length;i>s;s+=2)a=r[s],u=r[s+1],$(a).off(u,o);delete c[t]}},p="[r-style]",l=function(n,t){return n=n||p,$(n).each(function(n,e){var o,r;if(void 0===t){if(o=$.data(e,"constraints"))for(r in o)f(e,r)}else f(e,t)}),this},d=function(n){return n=n||p,$(n).each(function(n,t){var e=t.getAttribute("r-style"),o=e.split(";");o.forEach(function(n){var e,o,r;n&&(e=n.indexOf(":"),o=n.substr(0,e).replace(/ /g,""),r=n.substr(e+1),c(t,o,r))})}),this},h=function(n){return n=n||p,$(n).each(function(n,t){var e,o=$.data(t,"constraints");if(!o)return!1;for(e in o)o[e].update()}),this},m=function(n){return g=!n,n&&h(),this},$(window).on("load",function(){d()}),{applyConstraint:c,unbindConstraints:l,bindConstraints:d,setEnabled:m,updateConstraints:h}}();