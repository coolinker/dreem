var rheses=function(){function n(n,i){o[n]=i,t||e(r),t=!0}var e,t,o,r,i,s,a,u,c,f,p,d,l,h,m,w,v,y,b=!1,g=".rheses",E=$.style;return $.style=function(n,e,t){var o,r=E.apply(this,arguments);return void 0===t||b||(o=$.data(n,"sendstyle"),o&&o[e]&&$(n).trigger(e+g)),r},e=window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(n){setTimeout(n,17)},t=!1,o={},r=function(){for(var n in o)o[n]&&(o[n](),o[n]=null);t=!1},Mouse=function(){var e=0,t=0,o=null,r=$(this),i=$(document),s=function(){r.trigger("move")},a=function(r){o&&n("mousemove",s),e=r.pageX,t=r.pageY},u=function(){o||(o=!0,i.on("mousemove",a).one("mouseout",c))},c=function(){o&&(o=!1,i.off("mousemove",a).one("mouseover",u))},f=function(){return{top:t,left:e}},p={start:u,stop:c,position:f,offset:f,selector:r};return p}(),i={top:"position().top",left:"position().left",width:"width()",height:"height()",parent:"parent()"},s={scope:"this"},s.process=function(n){var e=function(n){for(;n.object&&"MemberExpression"===n.object.type;)n=n.object;return n.object||n},t=function(n,t){var o=e(n),r=o.name;t&&(o.name="$("+t+")","this"===t&&(o.name+="."+r))};this.scope="this",acorn.walkDown(n,this),t(n,this.scope)},s.Identifier=function(n){var e,t=n.name;t in i?n.name=i[t]:t in window&&(e=window[t],s.scope=e instanceof HTMLElement?"'#"+t+"'":e===window||e===document?t:null)},s.ThisExpression=function(n){n.type="Identifier",n.name="$(this)",s.scope=null},a={},a.MemberExpression=function(n){return s.process(n),!0},u={},u.MemberExpression=function(n){if("function"==typeof window[n.object.name])return!0;var e=n.property.name;return n=n.object,s.process(n),u.foundScopes.push({scope:acorn.stringify(n),propname:e}),!0},findScopes=function(n){var e=acorn.parse(n);return u.foundScopes=[],acorn.walkDown(e,u),u.foundScopes},c=function(n){var e;try{e=acorn.parse(n)}catch(t){return console.error("Failed to parse",n,"for",cssprop,"of",el),!1}return acorn.walkDown(e,a),acorn.stringify(e)},f=function(n,e){return Function([],n).bind(e)},p=0,d=function(e,t,o){function r(n,e){e.on(n+g,s.update),m.push(e)}var i,s,a,u,d,h,m,w;return parsedExpression=c(o),i=$.data(e,"constraints")||{},$.data(e,"constraints",i),i[t]&&l(e,t),i[t]||(i[t]={scopes:[]}),s=i[t],a=$(e),u=f("return "+parsedExpression,a),d=function(){a.css(t,u())},h=p++,s.update=function(){return b?void 0:(n(h,d),!1)},m=s.scopes,w={},findScopes(o).forEach(function(n){var i,s,u,c,p=n.scope,d=n.propname,l=p+"."+d;if(!w[l]&&(i=f("return "+p,a)(),0!==i.length)){if(i.length>1&&console.warn('"'+p+'" may have an error. Found multiple scopes, only using the first in: ',i),s=i&&i[0],s===e&&d===t)return console.warn('Not binding: expression "'+o+'" may have an error binding to own property',t,"on element",e),void 0;w[l]=!0,u=s&&(s===window||"body"===s.localName),!u||"width"!==d&&"height"!==d?i===Mouse&&(Mouse.start(),r("move",Mouse.selector)):r("resize",$(window)),s instanceof HTMLElement&&(c=$.data(s,"sendstyle"),c||(c=$.data(s,"sendstyle",{})),c[d]=!0,r(d,i))}}),s.update(),this},l=function(n,e){var t,o,r,i,s,a,u=$.data(n,"constraints");if(u){for(t=u&&u[e],o=t.update,r=t.scopes,i=0,s=r.length;s>i;i++)a=r[i],a.off(g,o);delete u[e]}},h="[r-style]",m=function(n,e){return n=n||h,$(n).each(function(n,t){var o,r;if(void 0===e){if(o=$.data(t,"constraints"))for(r in o)l(t,r)}else l(t,e)}),this},w=function(n){return n=n||h,$(n).each(function(n,e){var t=e.getAttribute("r-style"),o=t.split(";");o.forEach(function(n){var t,o,r;n&&(t=n.indexOf(":"),o=n.substr(0,t).replace(/ /g,""),r=n.substr(t+1),d(e,o,r))})}),this},v=function(n){return n=n||h,$(n).each(function(n,e){var t,o=$.data(e,"constraints");if(!o)return!1;for(t in o)o[t].update()}),this},y=function(n){return b=!n,n&&v(),this},$(window).on("load",function(){w()}),{applyConstraint:d,unbindConstraints:m,bindConstraints:w,setEnabled:y,updateConstraints:v}}(jQuery);