var rheses=function(){var t,n,e,s,o,r,i,a,c,u,f,p,d,h,l,m=!1,g=$.fn.css;return $.fn.css=function(){var t,n,e,s,o,r;if(g.apply(this,arguments),!m)for(t={},"object"!=typeof arguments[0]?t[arguments[0]]=arguments[1]:t=arguments[0],n=$(this),e=0,s=n.length;s>e;e++)if(o=$.data(n[e],"sendstyle"))for(r in t)o[r]&&n.trigger("style-"+r);return this},t=$.fn.animate,$.fn.animate=function(){var n,e,s,o,r,i,a,c,u=Array.prototype.slice.call(arguments,0);if(!m){"object"!=typeof u[1]&&(u[1]={duration:u[1],easing:u[2],complete:u[3]},u.length=2),n=$(this),e={},s=!1;for(o in u[0])for(r=0,i=n.length;i>r;r++)if(a=$.data(n[r],"sendstyle"),a&&a[o]){s=e[o]=!0;break}s&&(c=u[1].step,u[1].step=function(){c&&c.call(this,arguments);for(var t in e)n.trigger("style-"+t)})}return t.apply(this,u)},n=window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(t){setTimeout(t,17)},Mouse={left:0,top:0,started:null,dirty:!1,selector:null,sender:function(){this.started&&n(this.sender),this.dirty&&(this.dirty=!1,this.selector.trigger("move"))},handler:function(t){this.dirty=!0,this.left=t.pageX,this.top=t.pageY},start:function(){null===this.started&&(this.selector=$(this),this.offset=this.position,this.sender=this.sender.bind(this),this.handler=this.handler.bind(this)),this.started=!0,n(this.sender),$(document).on("mousemove",this.handler)},stop:function(){this.started=!1,$(document).off("mousemove",this.handler)},position:function(){return this}},e={top:"position().top",left:"position().left",width:"width()",height:"height()",parent:"parent()"},s={scope:"this"},s.process=function(t){var n=function(t){for(;t.object&&"MemberExpression"===t.object.type;)t=t.object;return t.object||t},e=function(t,e){var s=n(t),o=s.name;e&&(s.name="$("+e+")","this"===e&&(s.name+="."+o))};this.scope="this",acorn.walkDown(t,this),e(t,this.scope)},s.Identifier=function(t){var n,o=t.name;o in e?t.name=e[o]:o in window&&(n=window[o],s.scope=n instanceof HTMLElement?"'#"+o+"'":n===window||n===document?o:null)},s.ThisExpression=function(t){t.type="Identifier",t.name="$(this)",s.scope=null},o={},o.MemberExpression=function(t){return s.process(t),!0},r={foundScopes:[]},i={Math:!0},r.MemberExpression=function(t){if(t.object.name in i)return!0;var n=t.property.name;return t=t.object,s.process(t),r.foundScopes.push({scope:acorn.stringify(t),propname:n}),!0},findScopes=function(t){var n=acorn.parse(t);return r.foundScopes=[],acorn.walkDown(n,r),r.foundScopes},a=function(t,n){return Function([],t).bind(n)},c=function(t){var n;try{n=acorn.parse(t)}catch(e){return console.error("Failed to parse",t,"for",cssprop,"of",el),!1}return acorn.walkDown(n,o),acorn.stringify(n)},u=function(t,n,e){function s(t,n){t.on(n,r.update),p.push(t,n)}var o,r,i,u,f,p;return parsedExpression=c(e),o=$.data(t,"constraints")||{},$.data(t,"constraints",o),o[n]?!1:(o[n]={scopes:[]},r=o[n],i=$(t),u=a("return "+parsedExpression,i),r.update=function(t){t&&t.stopPropagation(),m||i.css(n,u())},f={},p=r.scopes,findScopes(e).forEach(function(o){var r,c,u,p,d=o.scope,h=o.propname,l=d+"."+h;if(!f[l]&&(r=a("return "+d,i)(),0!==r.length)){if(r.length>1&&console.warn('"'+d+'" may have an error. Found multiple scopes, only using the first in: ',r),c=r&&r[0],c===t&&h===n)return console.warn('Not binding: expression "'+e+'" may have an error binding to own property',n,"on element",t),void 0;f[l]=!0,u=c&&(c===window||"body"===c.localName),!u||"width"!==h&&"height"!==h?r===Mouse&&(Mouse.start(),s(Mouse.selector,"move")):s($(window),"resize"),c instanceof HTMLElement&&(p=$.data(c,"sendstyle")||{},p[h]=!0,$.data(c,"sendstyle",p),s(r,"style-"+h))}}),r.update(),this)},f=function(t,n){var e,s,o,r,i,a,c,u=$.data(t,"constraints");if(u){for(e=u&&u[n],s=e.update,o=e.scopes,r=0,i=o.length;i>r;r+=2)a=o[r],c=o[r+1],$(a).off(c,s);delete u[n]}},p=function(t,n){return t=t||"[r-style]",$(t).each(function(t,e){var s,o;if(void 0===n){if(s=$.data(e,"constraints"))for(o in s)f(e,o)}else f(e,n)}),this},d=function(t){return t=t||"[r-style]",$(t).each(function(t,n){var e=n.getAttribute("r-style"),s=e.split(";");s.forEach(function(t){var e,s,o;t&&(e=t.indexOf(":"),s=t.substr(0,e).replace(/ /g,""),o=t.substr(e+1),u(n,s,o))})}),this},h=function(t){return t=t||"[r-style]",$(t).each(function(t,n){var e,s=$.data(n,"constraints");if(!s)return!1;for(e in s)s[e].update()}),this},l=function(t){return m=!t,t&&h(),this},$(window).on("load",function(){d()}),{applyConstraint:u,unbindConstraints:p,bindConstraints:d,setEnabled:l,updateConstraints:h}}();