var rheses=function(){var n,t,e,o,r,i,s,a,u,c,f,p,d,l,m,h,g=!1,w=$.fn.css;return $.fn.css=function(){var n,t,e,o,r,i;if(w.apply(this,arguments),!g)for(n={},"object"!=typeof arguments[0]?n[arguments[0]]=arguments[1]:n=arguments[0],t=$(this),e=0,o=t.length;o>e;e++)if(r=$.data(t[e],"sendstyle"))for(i in n)r[i]&&t.trigger("style-"+i);return this},n=$.fn.animate,$.fn.animate=function(){var t,e,o,r,i,s,a,u,c=Array.prototype.slice.call(arguments,0);if(!g){"object"!=typeof c[1]&&(c[1]={duration:c[1],easing:c[2],complete:c[3]},c.length=2),t=$(this),e={},o=!1;for(r in c[0])for(i=0,s=t.length;s>i;i++)if(a=$.data(t[i],"sendstyle"),a&&a[r]){o=e[r]=!0;break}o&&(u=c[1].step,c[1].step=function(){u&&u.call(this,arguments);for(var n in e)t.trigger("style-"+n)})}return n.apply(this,c)},t=window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(n){setTimeout(n,17)},Mouse=function(){var n=0,e=0,o=null,r=!1,i=null,s=function(){o&&t(s),r&&(r=!1,i.trigger("move"))},a=function(t){r=!0,n=t.pageX,e=t.pageY},u=function(){null===o&&(i=$(Mouse)),o||(o=!0,t(s),$(document).on("mousemove",a),$(document).one("mouseout",c))},c=function(){o&&(o=!1,$(document).off("mousemove",a),$(document).one("mouseover",u))},f=function(){return{top:e,left:n}};return{start:u,stop:c,position:f,offset:f}}(),e={top:"position().top",left:"position().left",width:"width()",height:"height()",parent:"parent()"},o={scope:"this"},o.process=function(n){var t=function(n){for(;n.object&&"MemberExpression"===n.object.type;)n=n.object;return n.object||n},e=function(n,e){var o=t(n),r=o.name;e&&(o.name="$("+e+")","this"===e&&(o.name+="."+r))};this.scope="this",acorn.walkDown(n,this),e(n,this.scope)},o.Identifier=function(n){var t,r=n.name;r in e?n.name=e[r]:r in window&&(t=window[r],o.scope=t instanceof HTMLElement?"'#"+r+"'":t===window||t===document?r:null)},o.ThisExpression=function(n){n.type="Identifier",n.name="$(this)",o.scope=null},r={},r.MemberExpression=function(n){return o.process(n),!0},i={foundScopes:[]},s={Math:!0},i.MemberExpression=function(n){if(n.object.name in s)return!0;var t=n.property.name;return n=n.object,o.process(n),i.foundScopes.push({scope:acorn.stringify(n),propname:t}),!0},findScopes=function(n){var t=acorn.parse(n);return i.foundScopes=[],acorn.walkDown(t,i),i.foundScopes},a=function(n,t){return Function([],n).bind(t)},u=function(n){var t;try{t=acorn.parse(n)}catch(e){return console.error("Failed to parse",n,"for",cssprop,"of",el),!1}return acorn.walkDown(t,r),acorn.stringify(t)},c=function(n,t,e){function o(n,t){n.on(t,i.update),p.push(n,t)}var r,i,s,c,f,p;return parsedExpression=u(e),r=$.data(n,"constraints")||{},$.data(n,"constraints",r),r[t]?!1:(r[t]={scopes:[]},i=r[t],s=$(n),c=a("return "+parsedExpression,s),i.update=function(n){n&&n.stopPropagation(),g||s.css(t,c())},f={},p=i.scopes,findScopes(e).forEach(function(r){var i,u,c,p,d=r.scope,l=r.propname,m=d+"."+l;if(!f[m]&&(i=a("return "+d,s)(),0!==i.length)){if(i.length>1&&console.warn('"'+d+'" may have an error. Found multiple scopes, only using the first in: ',i),u=i&&i[0],u===n&&l===t)return console.warn('Not binding: expression "'+e+'" may have an error binding to own property',t,"on element",n),void 0;f[m]=!0,c=u&&(u===window||"body"===u.localName),!c||"width"!==l&&"height"!==l?i===Mouse&&(Mouse.start(),o($(Mouse),"move")):o($(window),"resize"),u instanceof HTMLElement&&(p=$.data(u,"sendstyle")||{},p[l]=!0,$.data(u,"sendstyle",p),o(i,"style-"+l))}}),i.update(),this)},f=function(n,t){var e,o,r,i,s,a,u,c=$.data(n,"constraints");if(c){for(e=c&&c[t],o=e.update,r=e.scopes,i=0,s=r.length;s>i;i+=2)a=r[i],u=r[i+1],$(a).off(u,o);delete c[t]}},p="[r-style]",d=function(n,t){return n=n||p,$(n).each(function(n,e){var o,r;if(void 0===t){if(o=$.data(e,"constraints"))for(r in o)f(e,r)}else f(e,t)}),this},l=function(n){return n=n||p,$(n).each(function(n,t){var e=t.getAttribute("r-style"),o=e.split(";");o.forEach(function(n){var e,o,r;n&&(e=n.indexOf(":"),o=n.substr(0,e).replace(/ /g,""),r=n.substr(e+1),c(t,o,r))})}),this},m=function(n){return n=n||p,$(n).each(function(n,t){var e,o=$.data(t,"constraints");if(!o)return!1;for(e in o)o[e].update()}),this},h=function(n){return g=!n,n&&m(),this},$(window).on("load",function(){l()}),{applyConstraint:c,unbindConstraints:d,bindConstraints:l,setEnabled:h,updateConstraints:m}}();