var rheses=function(){function n(n,i){o[n]=i,t||e(r),t=!0}var e,t,o,r,i,s,a,u,c,f,p,d,l,h,m,w,v,y=!1,b=".rheses",g=$.style;return $.style=function(n,e,t){var o,r=g.apply(this,arguments);return void 0===t||y||(o=$.data(n,"sendstyle"),o&&o[e]&&$(n).trigger(e+b)),r},e=window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||function(n){setTimeout(n,17)},t=!1,o={},r=function(){for(var n in o)o[n]();o={},t=!1},Mouse=function(){var e=0,t=0,o=null,r=$(this),i=$(document),s=function(){r.trigger("move")},a=function(r){o&&n("mousemove",s),e=r.pageX,t=r.pageY},u=function(){o||(o=!0,i.on("mousemove",a).one("mouseout",c))},c=function(){o&&(o=!1,i.off("mousemove",a).one("mouseover",u))},f=function(){return{top:t,left:e}},p={start:u,stop:c,position:f,offset:f,selector:r};return p}(),i={top:"position().top",left:"position().left",width:"width()",height:"height()",parent:"parent()"},s={scope:"this"},s.process=function(n){var e=function(n){for(;n.object&&"MemberExpression"===n.object.type;)n=n.object;return n.object||n},t=function(n,t){var o=e(n),r=o.name;t&&(o.name="$("+t+")","this"===t&&(o.name+="."+r))};this.scope="this",acorn.walkDown(n,this),t(n,this.scope)},s.Identifier=function(n){var e,t=n.name;t in i?n.name=i[t]:t in window&&(e=window[t],s.scope=e instanceof HTMLElement?"'#"+t+"'":e===window||e===document?t:null)},s.ThisExpression=function(n){n.type="Identifier",n.name="$(this)",s.scope=null},a={},a.MemberExpression=function(n){return s.process(n),!0},u={},u.MemberExpression=function(n){if("function"==typeof window[n.object.name])return!0;var e=n.property.name;return n=n.object,s.process(n),u.foundScopes.push({scope:acorn.stringify(n),propname:e}),!0},findScopes=function(n){var e=acorn.parse(n);return u.foundScopes=[],acorn.walkDown(e,u),u.foundScopes},c=function(n){var e;try{e=acorn.parse(n)}catch(t){return console.error("Failed to parse",n,"for",cssprop,"of",el),!1}return acorn.walkDown(e,a),acorn.stringify(e)},f=function(n,e){return Function([],n).bind(e)},p=function(n,e,t){function o(n,e){e.on(n+b,i.update),u.push(e)}var r,i,s,a,u,p;return parsedExpression=c(t),r=$.data(n,"constraints")||{},$.data(n,"constraints",r),r[e]&&d(n,e),r[e]||(r[e]={scopes:[]}),i=r[e],s=$(n),a=f("return "+parsedExpression,s),i.update=function(){return y?void 0:(s.css(e,a()),!1)},u=i.scopes,p={},findScopes(t).forEach(function(r){var i,a,u,c,d=r.scope,l=r.propname,h=d+"."+l;if(!p[h]&&(i=f("return "+d,s)(),0!==i.length)){if(i.length>1&&console.warn('"'+d+'" may have an error. Found multiple scopes, only using the first in: ',i),a=i&&i[0],a===n&&l===e)return console.warn('Not binding: expression "'+t+'" may have an error binding to own property',e,"on element",n),void 0;p[h]=!0,u=a&&(a===window||"body"===a.localName),!u||"width"!==l&&"height"!==l?i===Mouse&&(Mouse.start(),o("move",Mouse.selector)):o("resize",$(window)),a instanceof HTMLElement&&(c=$.data(a,"sendstyle"),c||(c=$.data(a,"sendstyle",{})),c[l]=!0,o(l,i))}}),i.update(),this},d=function(n,e){var t,o,r,i,s,a,u=$.data(n,"constraints");if(u){for(t=u&&u[e],o=t.update,r=t.scopes,i=0,s=r.length;s>i;i++)a=r[i],a.off(b,o);delete u[e]}},l="[r-style]",h=function(n,e){return n=n||l,$(n).each(function(n,t){var o,r;if(void 0===e){if(o=$.data(t,"constraints"))for(r in o)d(t,r)}else d(t,e)}),this},m=function(n){return n=n||l,$(n).each(function(n,e){var t=e.getAttribute("r-style"),o=t.split(";");o.forEach(function(n){var t,o,r;n&&(t=n.indexOf(":"),o=n.substr(0,t).replace(/ /g,""),r=n.substr(t+1),p(e,o,r))})}),this},w=function(n){return n=n||l,$(n).each(function(n,e){var t,o=$.data(e,"constraints");if(!o)return!1;for(t in o)o[t].update()}),this},v=function(n){return y=!n,n&&w(),this},$(window).on("load",function(){m()}),{applyConstraint:p,unbindConstraints:h,bindConstraints:m,setEnabled:v,updateConstraints:w}}(jQuery);